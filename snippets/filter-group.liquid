{%- comment -%}
  Collect and render all filters as a single accordion group.
{%- endcomment -%}

{%- capture all_accordion_items -%}
  {%- for filter in collection.filters -%}
    {%- capture filter_content -%}
      {%- if filter.type == 'boolean' or filter.type == 'list' and filter.values.first.param_name contains 'availability' -%}
        <ul id="{{ filter.param_name }}" class="filter-group filter-group--single-value" js-filter-group>
          {%- if filter.type == 'list' and filter.values.first.param_name contains 'availability' -%}
            {%- for value in filter.values -%}
              {%- if value.value == '1' -%}
                {%- capture filter_label -%}
                  {{ 'shared.filtering_and_sorting.in_stock_only' | t }}
                {%- endcapture -%}
                {%- render 'filter-item',
                    type: 'switch',
                    filter: filter,
                    value: value,
                    label: filter_label -%}
                {%- break -%}
              {%- endif -%}
            {%- endfor -%}
          {%- else -%}
            {%- assign filter_value = filter.true_value -%}
            {%- capture filter_label -%}{{ filter.label }}{%- endcapture -%}
            {%- render 'filter-item',
                type: 'switch',
                filter: filter,
                value: filter_value,
                label: filter_label -%}
          {%- endif -%}
        </ul>
      {%- elsif filter.range_max != 0 -%}
        {%- if filter.type == 'list' -%}
          {%- render 'list-filter',
              filter: filter,
              swatch_variant_options: swatch_variant_options,
              custom_swatch_color_key_map: custom_swatch_color_key_map,
              custom_swatch_color_value_map: custom_swatch_color_value_map -%}
        {%- else -%}
          {%- render 'price-range-filter', filter: filter -%}
        {%- endif -%}
      {%- endif -%}
    {%- endcapture -%}

    {%- unless filter_content == blank -%}
      {%- capture accordion_item -%}
        {%- render 'accordion-item',
            title: filter.label,
            content: filter_content,
            class: 'filter-group-wrapper' -%}
      {%- endcapture -%}
      {{ accordion_item }}
    {%- endunless -%}
  {%- endfor -%}
{%- endcapture -%}

<accordion-group data-single-open js-filter-group-parent>
  {{ all_accordion_items }}
</accordion-group>
