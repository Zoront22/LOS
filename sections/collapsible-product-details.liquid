{%- comment -%}
  Section: collapsible-product-details
  Renders a two-column layout with the accordion on the LEFT and the product details content on the RIGHT.
  - All styles are scoped to the rendered section id (#shopify-section-{{ section.id }}) so other instances are unaffected.
  - Desktop uses the exact measurements you provided (applied with !important).
  - Mobile (≤ 420px) switches to a single-column responsive layout optimized for iPhone.
  - Uses native <details>/<summary> for accessible accordion behavior (no external JS required).
{%- endcomment -%}
{%- liquid
  echo 'collapsible-product-details.css' | asset_url | stylesheet_tag
-%}

<section id="shopify-section-{{ section.id }}" class="section collapsible-left-product-details">
  <div class="collapsible-left__inner">
    <!-- RIGHT: Product details content -->
    <div class="collapsible-left__content">
      <div class="collapsible-left__small-label">{{ section.settings.small_label }}</div>

      <div class="collapsible-left__title-wrap">
        <h2 class="collapsible-left__title">{{ section.settings.title | escape }}</h2>
      </div>

      <div class="collapsible-left__description rte">
        {{ section.settings.description }}
      </div>
    </div>

    <!-- LEFT: Accordion group -->
    <div class="collapsible-left__accordion" role="region" aria-label="Product details accordion">
      <div class="collapsible-left__group-heading">
        {{ section.settings.group_label }}
      </div>

      {% for block in section.blocks %}
        {% if block.type == 'row' %}
          <details
            class="collapsible-row"
            {% if block.settings.expand_by_default %}
              open
            {% endif %}
          >
            <summary class="collapsible-row__summary">
              <span class="collapsible-row__title">{{ block.settings.heading }}</span>
              <button class="collapsible-row__button" aria-hidden="true" tabindex="-1"></button>
            </summary>
            <div class="collapsible-row__content rte">
              {{ block.settings.text }}
            </div>
          </details>
        {% endif %}
      {% endfor %}

      {% if section.blocks.size == 0 %}
        <!-- Fallback example rows -->
        <details class="collapsible-row" open>
          <summary class="collapsible-row__summary">
            <span class="collapsible-row__title">Product Features</span>
            <button class="collapsible-row__button" aria-hidden="true" tabindex="-1"></button>
          </summary>
          <div class="collapsible-row__content rte">
            <p>Short bullet points or features go here.</p>
          </div>
        </details>

        <details class="collapsible-row">
          <summary class="collapsible-row__summary">
            <span class="collapsible-row__title">Materials + Care</span>
            <button class="collapsible-row__button" aria-hidden="true" tabindex="-1"></button>
          </summary>
          <div class="collapsible-row__content rte">
            <p>Material composition and care instructions.</p>
          </div>
        </details>

        <details class="collapsible-row">
          <summary class="collapsible-row__summary">
            <span class="collapsible-row__title">Delivery & Returns</span>
            <button class="collapsible-row__button" aria-hidden="true" tabindex="-1"></button>
          </summary>
          <div class="collapsible-row__content rte">
            <p>Delivery windows, return policy summary.</p>
          </div>
        </details>
      {% endif %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Collapsible left",
  "settings": [
    {
      "type": "text",
      "id": "group_label",
      "label": "Accordion group label",
      "default": "Product details"
    },
    {
      "type": "text",
      "id": "small_label",
      "label": "Small label (left column heading)",
      "default": "PRODUCT DETAILS"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Main title",
      "default": "TOP QUALITY STRETCH FABRIC FOR UNRESTRICTED MOVEMENT"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description (lorem)",
      "default": "<p>Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis.</p>"
    }
  ],
  "blocks": [
    {
      "type": "row",
      "name": "Row (accordion)",
      "settings": [
        {
          "type": "checkbox",
          "id": "expand_by_default",
          "label": "Expand by default"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Row heading",
          "default": "Product Features"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Row text",
          "default": "<p>Details about this feature, materials or instructions.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collapsible left — Product details",
      "category": "Product"
    }
  ]
}
{% endschema %}
